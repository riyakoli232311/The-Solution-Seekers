<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Database Management - Campus Access Control</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fcampusacc6596back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.8"></script>
</head>
<body class="bg-background min-h-screen">
    <!-- Navigation Header -->
    <nav class="bg-surface shadow-institutional border-b border-secondary-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo and Brand -->
                <div class="flex items-center space-x-3">
                    <div class="flex-shrink-0">
                        <svg class="h-8 w-8 text-primary" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2L2 7v10c0 5.55 3.84 9.74 9 11 5.16-1.26 9-5.45 9-11V7l-10-5z"/>
                            <path d="M10 17l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z" fill="white"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-semibold text-text-primary">Campus Access Control</h1>
                        <p class="text-sm text-text-secondary">Database Management System</p>
                    </div>
                </div>

                <!-- Navigation Links -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="gate_access_verification.html" class="text-text-secondary hover:text-text-primary px-3 py-2 rounded-md text-sm font-medium transition-smooth">
                            Gate Access
                        </a>
                        <a href="access_logs_monitor.html" class="text-text-secondary hover:text-text-primary px-3 py-2 rounded-md text-sm font-medium transition-smooth">
                            Access Logs
                        </a>
                        <a href="database_management.html" class="bg-primary text-white px-3 py-2 rounded-md text-sm font-medium">
                            Database
                        </a>
                        <a href="security_dashboard.html" class="text-text-secondary hover:text-text-primary px-3 py-2 rounded-md text-sm font-medium transition-smooth">
                            Dashboard
                        </a>
                        <a href="system_login.html" class="text-text-secondary hover:text-text-primary px-3 py-2 rounded-md text-sm font-medium transition-smooth">
                            Logout
                        </a>
                    </div>
                </div>

                <!-- Mobile menu button -->
                <div class="md:hidden">
                    <button type="button" class="text-text-secondary hover:text-text-primary p-2 rounded-md" onclick="toggleMobileMenu()">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Navigation Menu -->
        <div id="mobile-menu" class="md:hidden hidden border-t border-secondary-200">
            <div class="px-2 pt-2 pb-3 space-y-1 bg-surface">
                <a href="gate_access_verification.html" class="text-text-secondary hover:text-text-primary block px-3 py-2 rounded-md text-base font-medium">
                    Gate Access
                </a>
                <a href="access_logs_monitor.html" class="text-text-secondary hover:text-text-primary block px-3 py-2 rounded-md text-base font-medium">
                    Access Logs
                </a>
                <a href="database_management.html" class="bg-primary text-white block px-3 py-2 rounded-md text-base font-medium">
                    Database
                </a>
                <a href="security_dashboard.html" class="text-text-secondary hover:text-text-primary block px-3 py-2 rounded-md text-base font-medium">
                    Dashboard
                </a>
                <a href="system_login.html" class="text-text-secondary hover:text-text-primary block px-3 py-2 rounded-md text-base font-medium">
                    Logout
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Page Header -->
        <div class="mb-8">
            <h2 class="text-3xl font-bold text-text-primary">Database Management</h2>
            <p class="mt-2 text-text-secondary">Manage student, staff, and vehicle registration records</p>
        </div>

        <!-- Tab Navigation -->
        <div class="mb-6">
            <div class="border-b border-secondary-200">
                <nav class="-mb-px flex space-x-8">
                    <button id="students-tab" class="tab-button active py-2 px-1 border-b-2 font-medium text-sm" onclick="switchTab('students')">
                        <svg class="inline-block w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Students & Staff
                    </button>
                    <button id="vehicles-tab" class="tab-button py-2 px-1 border-b-2 font-medium text-sm" onclick="switchTab('vehicles')">
                        <svg class="inline-block w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
                            <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1V8a1 1 0 00-1-1h-3z"/>
                        </svg>
                        Vehicle Records
                    </button>
                </nav>
            </div>
        </div>

        <!-- Students & Staff Tab Content -->
        <div id="students-content" class="tab-content">
            <!-- Filter Controls -->
            <div class="card mb-6">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                    <div class="flex flex-col sm:flex-row gap-4 flex-1">
                        <div class="flex-1">
                            <input type="text" id="student-search" class="input-field" placeholder="Search by name, ID, or email..." oninput="filterStudents()" />
                        </div>
                        <div class="flex gap-2">
                            <select id="department-filter" class="input-field" onchange="filterStudents()">
                                <option value>All Departments</option>
                                <option value="Computer Science">Computer Science</option>
                                <option value="Engineering">Engineering</option>
                                <option value="Business">Business</option>
                                <option value="Arts">Arts</option>
                                <option value="Administration">Administration</option>
                            </select>
                            <select id="status-filter" class="input-field" onchange="filterStudents()">
                                <option value>All Status</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="suspended">Suspended</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button class="btn-secondary" onclick="exportStudentData()">
                            <svg class="inline-block w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                            Export CSV
                        </button>
                        <button class="btn-accent" onclick="importStudentData()">
                            <svg class="inline-block w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 11-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                            </svg>
                            Import CSV
                        </button>
                        <button class="btn-primary" onclick="openAddStudentModal()">
                            <svg class="inline-block w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                            </svg>
                            Add New Record
                        </button>
                    </div>
                </div>

                <!-- Bulk Actions -->
                <div id="bulk-actions" class="hidden mt-4 p-4 bg-secondary-50 rounded-lg border border-secondary-200">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-text-secondary">
                            <span id="selected-count">0</span> records selected
                        </span>
                        <div class="flex gap-2">
                            <button class="btn-secondary text-sm py-1 px-3" onclick="bulkActivate()">Activate</button>
                            <button class="btn-secondary text-sm py-1 px-3" onclick="bulkDeactivate()">Deactivate</button>
                            <button class="btn-secondary text-sm py-1 px-3" onclick="bulkDelete()">Delete</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Students Table -->
            <div class="card overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-secondary-200">
                        <thead class="bg-secondary-50">
                            <tr>
                                <th class="px-6 py-3 text-left">
                                    <input type="checkbox" id="select-all-students" class="rounded border-secondary-300 text-primary focus:ring-primary" onchange="toggleSelectAll('students')" />
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">ID</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Name</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Email</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Department</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Vehicles</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="students-table-body" class="bg-surface divide-y divide-secondary-200">
                            <!-- Student rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Vehicle Records Tab Content -->
        <div id="vehicles-content" class="tab-content hidden">
            <!-- Filter Controls -->
            <div class="card mb-6">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                    <div class="flex flex-col sm:flex-row gap-4 flex-1">
                        <div class="flex-1">
                            <input type="text" id="vehicle-search" class="input-field" placeholder="Search by license plate, owner, or make..." oninput="filterVehicles()" />
                        </div>
                        <div class="flex gap-2">
                            <select id="vehicle-status-filter" class="input-field" onchange="filterVehicles()">
                                <option value>All Status</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="suspended">Suspended</option>
                            </select>
                            <select id="vehicle-type-filter" class="input-field" onchange="filterVehicles()">
                                <option value>All Types</option>
                                <option value="Car">Car</option>
                                <option value="Motorcycle">Motorcycle</option>
                                <option value="Truck">Truck</option>
                                <option value="SUV">SUV</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button class="btn-secondary" onclick="exportVehicleData()">
                            <svg class="inline-block w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                            Export CSV
                        </button>
                        <button class="btn-primary" onclick="openAddVehicleModal()">
                            <svg class="inline-block w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                            </svg>
                            Add Vehicle
                        </button>
                    </div>
                </div>
            </div>

            <!-- Vehicles Table -->
            <div class="card overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-secondary-200">
                        <thead class="bg-secondary-50">
                            <tr>
                                <th class="px-6 py-3 text-left">
                                    <input type="checkbox" id="select-all-vehicles" class="rounded border-secondary-300 text-primary focus:ring-primary" onchange="toggleSelectAll('vehicles')" />
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">License Plate</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Owner</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Owner ID</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Make/Model</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Type</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="vehicles-table-body" class="bg-surface divide-y divide-secondary-200">
                            <!-- Vehicle rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Student Modal -->
    <div id="add-student-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-surface rounded-lg shadow-lg max-w-2xl w-full max-h-screen overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-text-primary">Add New Student/Staff Record</h3>
                    <button onclick="closeAddStudentModal()" class="text-text-secondary hover:text-text-primary">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>

                <form id="student-form" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">ID Number *</label>
                            <input type="text" id="student-id-input" class="input-field font-data" placeholder="STU2025001 or STF2025001" maxlength="10" required />
                            <p class="mt-1 text-sm text-text-secondary">Format: STU/STF + Year + 3-digit number</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Type *</label>
                            <select id="person-type" class="input-field" required>
                                <option value>Select Type</option>
                                <option value="Student">Student</option>
                                <option value="Staff">Staff</option>
                                <option value="Faculty">Faculty</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">First Name *</label>
                            <input type="text" id="first-name" class="input-field" required />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Last Name *</label>
                            <input type="text" id="last-name" class="input-field" required />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Email *</label>
                            <input type="email" id="email" class="input-field" required />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Phone</label>
                            <input type="tel" id="phone" class="input-field" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Department *</label>
                            <select id="department" class="input-field" required>
                                <option value>Select Department</option>
                                <option value="Computer Science">Computer Science</option>
                                <option value="Engineering">Engineering</option>
                                <option value="Business">Business</option>
                                <option value="Arts">Arts</option>
                                <option value="Administration">Administration</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Status</label>
                            <select id="person-status" class="input-field">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="suspended">Suspended</option>
                            </select>
                        </div>
                    </div>

                    <div class="flex justify-end gap-4 pt-6 border-t border-secondary-200">
                        <button type="button" class="btn-secondary" onclick="closeAddStudentModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Add Record</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Vehicle Modal -->
    <div id="add-vehicle-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-surface rounded-lg shadow-lg max-w-2xl w-full max-h-screen overflow-y-auto">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-text-primary">Add New Vehicle Record</h3>
                    <button onclick="closeAddVehicleModal()" class="text-text-secondary hover:text-text-primary">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>

                <form id="vehicle-form" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">License Plate *</label>
                            <input type="text" id="license-plate" class="input-field font-data" placeholder="ABC-1234" maxlength="10" style="text-transform: uppercase;" required />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Owner *</label>
                            <select id="vehicle-owner" class="input-field" required>
                                <option value>Select Owner</option>
                                <!-- Options will be populated by JavaScript -->
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Make *</label>
                            <input type="text" id="vehicle-make" class="input-field" placeholder="Toyota" required />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Model *</label>
                            <input type="text" id="vehicle-model" class="input-field" placeholder="Camry" required />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Year</label>
                            <input type="number" id="vehicle-year" class="input-field" placeholder="2023" min="1900" max="2025" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Color</label>
                            <input type="text" id="vehicle-color" class="input-field" placeholder="Blue" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Type *</label>
                            <select id="vehicle-type" class="input-field" required>
                                <option value>Select Type</option>
                                <option value="Car">Car</option>
                                <option value="Motorcycle">Motorcycle</option>
                                <option value="Truck">Truck</option>
                                <option value="SUV">SUV</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-text-primary mb-2">Status</label>
                            <select id="vehicle-status" class="input-field">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="suspended">Suspended</option>
                            </select>
                        </div>
                    </div>

                    <div class="flex justify-end gap-4 pt-6 border-t border-secondary-200">
                        <button type="button" class="btn-secondary" onclick="closeAddVehicleModal()">Cancel</button>
                        <button type="submit" class="btn-primary">Add Vehicle</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Mock data
        let studentsData = [
            {
                id: 'STU2024001',
                type: 'Student',
                firstName: 'John',
                lastName: 'Smith',
                email: 'john.smith@campus.edu',
                phone: '(555) 123-4567',
                department: 'Computer Science',
                status: 'active',
                vehicles: ['ABC-1234']
            },
            {
                id: 'STF2024001',
                type: 'Staff',
                firstName: 'Sarah',
                lastName: 'Johnson',
                email: 'sarah.johnson@campus.edu',
                phone: '(555) 234-5678',
                department: 'Administration',
                status: 'active',
                vehicles: ['XYZ-5678']
            },
            {
                id: 'STU2024002',
                type: 'Student',
                firstName: 'Mike',
                lastName: 'Wilson',
                email: 'mike.wilson@campus.edu',
                phone: '(555) 345-6789',
                department: 'Engineering',
                status: 'suspended',
                vehicles: ['DEF-9012']
            },
            {
                id: 'STF2024002',
                type: 'Faculty',
                firstName: 'Emily',
                lastName: 'Davis',
                email: 'emily.davis@campus.edu',
                phone: '(555) 456-7890',
                department: 'Business',
                status: 'active',
                vehicles: ['GHI-3456']
            },
            {
                id: 'STU2024003',
                type: 'Student',
                firstName: 'Alex',
                lastName: 'Brown',
                email: 'alex.brown@campus.edu',
                phone: '(555) 567-8901',
                department: 'Arts',
                status: 'active',
                vehicles: []
            }
        ];

        let vehiclesData = [
            {
                licensePlate: 'ABC-1234',
                ownerId: 'STU2024001',
                ownerName: 'John Smith',
                make: 'Toyota',
                model: 'Camry',
                year: 2022,
                color: 'Blue',
                type: 'Car',
                status: 'active'
            },
            {
                licensePlate: 'XYZ-5678',
                ownerId: 'STF2024001',
                ownerName: 'Sarah Johnson',
                make: 'Honda',
                model: 'Civic',
                year: 2023,
                color: 'White',
                type: 'Car',
                status: 'active'
            },
            {
                licensePlate: 'DEF-9012',
                ownerId: 'STU2024002',
                ownerName: 'Mike Wilson',
                make: 'Ford',
                model: 'F-150',
                year: 2021,
                color: 'Black',
                type: 'Truck',
                status: 'suspended'
            },
            {
                licensePlate: 'GHI-3456',
                ownerId: 'STF2024002',
                ownerName: 'Emily Davis',
                make: 'BMW',
                model: 'X5',
                year: 2024,
                color: 'Silver',
                type: 'SUV',
                status: 'active'
            }
        ];

        let filteredStudents = [...studentsData];
        let filteredVehicles = [...vehiclesData];

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active', 'border-primary', 'text-primary');
                btn.classList.add('border-transparent', 'text-text-secondary', 'hover:text-text-primary', 'hover:border-secondary-300');
            });

            const activeTab = document.getElementById(`${tabName}-tab`);
            activeTab.classList.add('active', 'border-primary', 'text-primary');
            activeTab.classList.remove('border-transparent', 'text-text-secondary', 'hover:text-text-primary', 'hover:border-secondary-300');

            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabName}-content`).classList.remove('hidden');

            // Load data for the active tab
            if (tabName === 'students') {
                renderStudentsTable();
            } else if (tabName === 'vehicles') {
                renderVehiclesTable();
                populateVehicleOwnerOptions();
            }
        }

        function renderStudentsTable() {
            const tbody = document.getElementById('students-table-body');
            tbody.innerHTML = '';

            filteredStudents.forEach((student, index) => {
                const row = document.createElement('tr');
                row.className = 'table-row';
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <input type="checkbox" class="student-checkbox rounded border-secondary-300 text-primary focus:ring-primary" data-index="${index}">
                    </td>
                    <td class="px-6 py-4 text-sm font-data text-text-primary">${student.id}</td>
                    <td class="px-6 py-4 text-sm text-text-primary">${student.firstName} ${student.lastName}</td>
                    <td class="px-6 py-4 text-sm text-text-primary">${student.email}</td>
                    <td class="px-6 py-4 text-sm text-text-primary">${student.department}</td>
                    <td class="px-6 py-4">
                        <span class="status-${student.status === 'active' ? 'success' : student.status === 'suspended' ? 'error' : 'warning'}">
                            ${student.status.charAt(0).toUpperCase() + student.status.slice(1)}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-text-primary">
                        ${student.vehicles.length > 0 ? 
                            student.vehicles.map(plate => `<span class="font-data bg-secondary-100 px-2 py-1 rounded text-xs mr-1">${plate}</span>`).join('') : 
                            '<span class="text-text-secondary">None</span>'
                        }
                    </td>
                    <td class="px-6 py-4 text-sm">
                        <div class="flex space-x-2">
                            <button class="text-primary hover:text-primary-700" onclick="editStudent(${index})" title="Edit">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                </svg>
                            </button>
                            <button class="text-error hover:text-error-700" onclick="deleteStudent(${index})" title="Delete">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });

            updateBulkActions();
        }

        function renderVehiclesTable() {
            const tbody = document.getElementById('vehicles-table-body');
            tbody.innerHTML = '';

            filteredVehicles.forEach((vehicle, index) => {
                const row = document.createElement('tr');
                row.className = 'table-row';
                row.innerHTML = `
                    <td class="px-6 py-4">
                        <input type="checkbox" class="vehicle-checkbox rounded border-secondary-300 text-primary focus:ring-primary" data-index="${index}">
                    </td>
                    <td class="px-6 py-4 text-sm font-data text-text-primary">${vehicle.licensePlate}</td>
                    <td class="px-6 py-4 text-sm text-text-primary">${vehicle.ownerName}</td>
                    <td class="px-6 py-4 text-sm font-data text-text-primary">${vehicle.ownerId}</td>
                    <td class="px-6 py-4 text-sm text-text-primary">${vehicle.make} ${vehicle.model} ${vehicle.year ? `(${vehicle.year})` : ''}</td>
                    <td class="px-6 py-4 text-sm text-text-primary">${vehicle.type}</td>
                    <td class="px-6 py-4">
                        <span class="status-${vehicle.status === 'active' ? 'success' : vehicle.status === 'suspended' ? 'error' : 'warning'}">
                            ${vehicle.status.charAt(0).toUpperCase() + vehicle.status.slice(1)}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm">
                        <div class="flex space-x-2">
                            <button class="text-primary hover:text-primary-700" onclick="editVehicle(${index})" title="Edit">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                </svg>
                            </button>
                            <button class="text-error hover:text-error-700" onclick="deleteVehicle(${index})" title="Delete">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterStudents() {
            const searchTerm = document.getElementById('student-search').value.toLowerCase();
            const departmentFilter = document.getElementById('department-filter').value;
            const statusFilter = document.getElementById('status-filter').value;

            filteredStudents = studentsData.filter(student => {
                const matchesSearch = !searchTerm || 
                    student.firstName.toLowerCase().includes(searchTerm) ||
                    student.lastName.toLowerCase().includes(searchTerm) ||
                    student.email.toLowerCase().includes(searchTerm) ||
                    student.id.toLowerCase().includes(searchTerm);

                const matchesDepartment = !departmentFilter || student.department === departmentFilter;
                const matchesStatus = !statusFilter || student.status === statusFilter;

                return matchesSearch && matchesDepartment && matchesStatus;
            });

            renderStudentsTable();
        }

        function filterVehicles() {
            const searchTerm = document.getElementById('vehicle-search').value.toLowerCase();
            const statusFilter = document.getElementById('vehicle-status-filter').value;
            const typeFilter = document.getElementById('vehicle-type-filter').value;

            filteredVehicles = vehiclesData.filter(vehicle => {
                const matchesSearch = !searchTerm || 
                    vehicle.licensePlate.toLowerCase().includes(searchTerm) ||
                    vehicle.ownerName.toLowerCase().includes(searchTerm) ||
                    vehicle.make.toLowerCase().includes(searchTerm) ||
                    vehicle.model.toLowerCase().includes(searchTerm);

                const matchesStatus = !statusFilter || vehicle.status === statusFilter;
                const matchesType = !typeFilter || vehicle.type === typeFilter;

                return matchesSearch && matchesStatus && matchesType;
            });

            renderVehiclesTable();
        }

        function toggleSelectAll(type) {
            const selectAll = document.getElementById(`select-all-${type}`);
            const checkboxes = document.querySelectorAll(`.${type.slice(0, -1)}-checkbox`);
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });

            updateBulkActions();
        }

        function updateBulkActions() {
            const selectedStudents = document.querySelectorAll('.student-checkbox:checked').length;
            const selectedVehicles = document.querySelectorAll('.vehicle-checkbox:checked').length;
            const totalSelected = selectedStudents + selectedVehicles;

            const bulkActions = document.getElementById('bulk-actions');
            const selectedCount = document.getElementById('selected-count');

            if (totalSelected > 0) {
                bulkActions.classList.remove('hidden');
                selectedCount.textContent = totalSelected;
            } else {
                bulkActions.classList.add('hidden');
            }
        }

        function openAddStudentModal() {
            document.getElementById('add-student-modal').classList.remove('hidden');
        }

        function closeAddStudentModal() {
            document.getElementById('add-student-modal').classList.add('hidden');
            document.getElementById('student-form').reset();
        }

        function openAddVehicleModal() {
            populateVehicleOwnerOptions();
            document.getElementById('add-vehicle-modal').classList.remove('hidden');
        }

        function closeAddVehicleModal() {
            document.getElementById('add-vehicle-modal').classList.add('hidden');
            document.getElementById('vehicle-form').reset();
        }

        function populateVehicleOwnerOptions() {
            const select = document.getElementById('vehicle-owner');
            select.innerHTML = '<option value="">Select Owner</option>';
            
            studentsData.forEach(student => {
                const option = document.createElement('option');
                option.value = student.id;
                option.textContent = `${student.firstName} ${student.lastName} (${student.id})`;
                select.appendChild(option);
            });
        }

        function editStudent(index) {
            const student = filteredStudents[index];
            // In a real application, this would open an edit modal with pre-filled data
            alert(`Edit functionality for ${student.firstName} ${student.lastName} would be implemented here.`);
        }

        function deleteStudent(index) {
            const student = filteredStudents[index];
            if (confirm(`Are you sure you want to delete ${student.firstName} ${student.lastName}?`)) {
                const originalIndex = studentsData.findIndex(s => s.id === student.id);
                studentsData.splice(originalIndex, 1);
                filterStudents();
            }
        }

        function editVehicle(index) {
            const vehicle = filteredVehicles[index];
            alert(`Edit functionality for vehicle ${vehicle.licensePlate} would be implemented here.`);
        }

        function deleteVehicle(index) {
            const vehicle = filteredVehicles[index];
            if (confirm(`Are you sure you want to delete vehicle ${vehicle.licensePlate}?`)) {
                const originalIndex = vehiclesData.findIndex(v => v.licensePlate === vehicle.licensePlate);
                vehiclesData.splice(originalIndex, 1);
                filterVehicles();
            }
        }

        function bulkActivate() {
            alert('Bulk activate functionality would be implemented here.');
        }

        function bulkDeactivate() {
            alert('Bulk deactivate functionality would be implemented here.');
        }

        function bulkDelete() {
            if (confirm('Are you sure you want to delete all selected records?')) {
                alert('Bulk delete functionality would be implemented here.');
            }
        }

        function exportStudentData() {
            alert('Export student data to CSV functionality would be implemented here.');
        }

        function exportVehicleData() {
            alert('Export vehicle data to CSV functionality would be implemented here.');
        }

        function importStudentData() {
            alert('Import student data from CSV functionality would be implemented here.');
        }

        // Form submissions
        document.getElementById('student-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const newStudent = {
                id: document.getElementById('student-id-input').value,
                type: document.getElementById('person-type').value,
                firstName: document.getElementById('first-name').value,
                lastName: document.getElementById('last-name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                department: document.getElementById('department').value,
                status: document.getElementById('person-status').value,
                vehicles: []
            };

            // Validate ID format
            const idPattern = /^(STU|STF)\d{7}$/;
            if (!idPattern.test(newStudent.id)) {
                alert('Invalid ID format. Please use STU/STF + Year + 3-digit number.');
                return;
            }

            // Check for duplicate ID
            if (studentsData.some(s => s.id === newStudent.id)) {
                alert('A record with this ID already exists.');
                return;
            }

            studentsData.push(newStudent);
            filterStudents();
            closeAddStudentModal();
            alert('Student record added successfully!');
        });

        document.getElementById('vehicle-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const ownerId = document.getElementById('vehicle-owner').value;
            const owner = studentsData.find(s => s.id === ownerId);
            
            const newVehicle = {
                licensePlate: document.getElementById('license-plate').value.toUpperCase(),
                ownerId: ownerId,
                ownerName: owner ? `${owner.firstName} ${owner.lastName}` : '',
                make: document.getElementById('vehicle-make').value,
                model: document.getElementById('vehicle-model').value,
                year: parseInt(document.getElementById('vehicle-year').value) || null,
                color: document.getElementById('vehicle-color').value,
                type: document.getElementById('vehicle-type').value,
                status: document.getElementById('vehicle-status').value
            };

            // Check for duplicate license plate
            if (vehiclesData.some(v => v.licensePlate === newVehicle.licensePlate)) {
                alert('A vehicle with this license plate already exists.');
                return;
            }

            vehiclesData.push(newVehicle);
            
            // Update owner's vehicle list
            if (owner) {
                owner.vehicles.push(newVehicle.licensePlate);
            }

            filterVehicles();
            closeAddVehicleModal();
            alert('Vehicle record added successfully!');
        });

        // Event listeners for bulk actions
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('student-checkbox') || e.target.classList.contains('vehicle-checkbox')) {
                updateBulkActions();
            }
        });

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            switchTab('students');
        });

        // Add CSS for tab styling
        const style = document.createElement('style');
        style.textContent = `
            .tab-button {
                transition: all 0.2s ease;
            }
            .tab-button.active {
                border-color: var(--color-primary);
                color: var(--color-primary);
            }
            .tab-button:not(.active) {
                border-color: transparent;
                color: var(--color-text-secondary);
            }
            .tab-button:not(.active):hover {
                color: var(--color-text-primary);
                border-color: var(--color-secondary-300);
            }
        `;
        document.head.appendChild(style);
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>